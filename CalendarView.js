import { __awaiter } from "tslib";
import { ItemView } from 'obsidian';
import { CalendarRenderer } from './CalendarRenderer';
import { EventModal } from './EventModal';
import { EventListModal } from './EventListModal';
export const VIEW_TYPE_CALENDAR = 'calendar-event-planner';
export class CalendarView extends ItemView {
    constructor(leaf, eventManager) {
        super(leaf);
        this.eventManager = eventManager;
    }
    getViewType() {
        return VIEW_TYPE_CALENDAR;
    }
    getDisplayText() {
        return 'Calendar';
    }
    getIcon() {
        return 'calendar';
    }
    onOpen() {
        return __awaiter(this, void 0, void 0, function* () {
            const container = this.containerEl.children[1];
            container.empty();
            container.addClass('calendar-view-container');
            // Load events
            yield this.eventManager.loadEvents();
            // Initialize renderer
            this.renderer = new CalendarRenderer(container, this.eventManager, this.openEventModal.bind(this), this.openEventListModal.bind(this));
            // Render calendar
            this.renderer.render();
        });
    }
    onClose() {
        return __awaiter(this, void 0, void 0, function* () {
            // Cleanup
        });
    }
    openEventModal(date, eventIndex = null) {
        new EventModal(this.app, this.eventManager, date, eventIndex, () => this.renderer.refresh()).open();
    }
    openEventListModal(date) {
        new EventListModal(this.app, this.eventManager, date, (eventIndex) => this.openEventModal(date, eventIndex), () => this.renderer.refresh()).open();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2FsZW5kYXJWaWV3LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQ2FsZW5kYXJWaWV3LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFpQixNQUFNLFVBQVUsQ0FBQztBQUVuRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUN0RCxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQzFDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUVsRCxNQUFNLENBQUMsTUFBTSxrQkFBa0IsR0FBRyx3QkFBd0IsQ0FBQztBQUUzRCxNQUFNLE9BQU8sWUFBYSxTQUFRLFFBQVE7SUFJeEMsWUFBWSxJQUFtQixFQUFFLFlBQTBCO1FBQ3pELEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNaLElBQUksQ0FBQyxZQUFZLEdBQUcsWUFBWSxDQUFDO0lBQ25DLENBQUM7SUFFRCxXQUFXO1FBQ1QsT0FBTyxrQkFBa0IsQ0FBQztJQUM1QixDQUFDO0lBRUQsY0FBYztRQUNaLE9BQU8sVUFBVSxDQUFDO0lBQ3BCLENBQUM7SUFFRCxPQUFPO1FBQ0wsT0FBTyxVQUFVLENBQUM7SUFDcEIsQ0FBQztJQUVLLE1BQU07O1lBQ1YsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0MsU0FBUyxDQUFDLEtBQUssRUFBRSxDQUFDO1lBQ2xCLFNBQVMsQ0FBQyxRQUFRLENBQUMseUJBQXlCLENBQUMsQ0FBQztZQUU5QyxjQUFjO1lBQ2QsTUFBTSxJQUFJLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBRXJDLHNCQUFzQjtZQUN0QixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksZ0JBQWdCLENBQ2xDLFNBQXdCLEVBQ3hCLElBQUksQ0FBQyxZQUFZLEVBQ2pCLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUM5QixJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUNuQyxDQUFDO1lBRUYsa0JBQWtCO1lBQ2xCLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDekIsQ0FBQztLQUFBO0lBRUssT0FBTzs7WUFDWCxVQUFVO1FBQ1osQ0FBQztLQUFBO0lBRU8sY0FBYyxDQUFDLElBQVksRUFBRSxhQUE0QixJQUFJO1FBQ25FLElBQUksVUFBVSxDQUNaLElBQUksQ0FBQyxHQUFHLEVBQ1IsSUFBSSxDQUFDLFlBQVksRUFDakIsSUFBSSxFQUNKLFVBQVUsRUFDVixHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxDQUM5QixDQUFDLElBQUksRUFBRSxDQUFDO0lBQ1gsQ0FBQztJQUVPLGtCQUFrQixDQUFDLElBQVk7UUFDckMsSUFBSSxjQUFjLENBQ2hCLElBQUksQ0FBQyxHQUFHLEVBQ1IsSUFBSSxDQUFDLFlBQVksRUFDakIsSUFBSSxFQUNKLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsRUFDckQsR0FBRyxFQUFFLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FDOUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNYLENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEl0ZW1WaWV3LCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBFdmVudE1hbmFnZXIgfSBmcm9tICcuL0V2ZW50TWFuYWdlcic7XHJcbmltcG9ydCB7IENhbGVuZGFyUmVuZGVyZXIgfSBmcm9tICcuL0NhbGVuZGFyUmVuZGVyZXInO1xyXG5pbXBvcnQgeyBFdmVudE1vZGFsIH0gZnJvbSAnLi9FdmVudE1vZGFsJztcclxuaW1wb3J0IHsgRXZlbnRMaXN0TW9kYWwgfSBmcm9tICcuL0V2ZW50TGlzdE1vZGFsJztcclxuXHJcbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfQ0FMRU5EQVIgPSAnY2FsZW5kYXItZXZlbnQtcGxhbm5lcic7XHJcblxyXG5leHBvcnQgY2xhc3MgQ2FsZW5kYXJWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xyXG4gIHByaXZhdGUgZXZlbnRNYW5hZ2VyOiBFdmVudE1hbmFnZXI7XHJcbiAgcHJpdmF0ZSByZW5kZXJlcjogQ2FsZW5kYXJSZW5kZXJlcjtcclxuXHJcbiAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgZXZlbnRNYW5hZ2VyOiBFdmVudE1hbmFnZXIpIHtcclxuICAgIHN1cGVyKGxlYWYpO1xyXG4gICAgdGhpcy5ldmVudE1hbmFnZXIgPSBldmVudE1hbmFnZXI7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3VHlwZSgpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIFZJRVdfVFlQRV9DQUxFTkRBUjtcclxuICB9XHJcblxyXG4gIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gJ0NhbGVuZGFyJztcclxuICB9XHJcblxyXG4gIGdldEljb24oKTogc3RyaW5nIHtcclxuICAgIHJldHVybiAnY2FsZW5kYXInO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgb25PcGVuKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXTtcclxuICAgIGNvbnRhaW5lci5lbXB0eSgpO1xyXG4gICAgY29udGFpbmVyLmFkZENsYXNzKCdjYWxlbmRhci12aWV3LWNvbnRhaW5lcicpO1xyXG5cclxuICAgIC8vIExvYWQgZXZlbnRzXHJcbiAgICBhd2FpdCB0aGlzLmV2ZW50TWFuYWdlci5sb2FkRXZlbnRzKCk7XHJcblxyXG4gICAgLy8gSW5pdGlhbGl6ZSByZW5kZXJlclxyXG4gICAgdGhpcy5yZW5kZXJlciA9IG5ldyBDYWxlbmRhclJlbmRlcmVyKFxyXG4gICAgICBjb250YWluZXIgYXMgSFRNTEVsZW1lbnQsXHJcbiAgICAgIHRoaXMuZXZlbnRNYW5hZ2VyLFxyXG4gICAgICB0aGlzLm9wZW5FdmVudE1vZGFsLmJpbmQodGhpcyksXHJcbiAgICAgIHRoaXMub3BlbkV2ZW50TGlzdE1vZGFsLmJpbmQodGhpcylcclxuICAgICk7XHJcblxyXG4gICAgLy8gUmVuZGVyIGNhbGVuZGFyXHJcbiAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcigpO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgb25DbG9zZSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIC8vIENsZWFudXBcclxuICB9XHJcblxyXG4gIHByaXZhdGUgb3BlbkV2ZW50TW9kYWwoZGF0ZTogc3RyaW5nLCBldmVudEluZGV4OiBudW1iZXIgfCBudWxsID0gbnVsbCk6IHZvaWQge1xyXG4gICAgbmV3IEV2ZW50TW9kYWwoXHJcbiAgICAgIHRoaXMuYXBwLFxyXG4gICAgICB0aGlzLmV2ZW50TWFuYWdlcixcclxuICAgICAgZGF0ZSxcclxuICAgICAgZXZlbnRJbmRleCxcclxuICAgICAgKCkgPT4gdGhpcy5yZW5kZXJlci5yZWZyZXNoKClcclxuICAgICkub3BlbigpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvcGVuRXZlbnRMaXN0TW9kYWwoZGF0ZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBuZXcgRXZlbnRMaXN0TW9kYWwoXHJcbiAgICAgIHRoaXMuYXBwLFxyXG4gICAgICB0aGlzLmV2ZW50TWFuYWdlcixcclxuICAgICAgZGF0ZSxcclxuICAgICAgKGV2ZW50SW5kZXgpID0+IHRoaXMub3BlbkV2ZW50TW9kYWwoZGF0ZSwgZXZlbnRJbmRleCksXHJcbiAgICAgICgpID0+IHRoaXMucmVuZGVyZXIucmVmcmVzaCgpXHJcbiAgICApLm9wZW4oKTtcclxuICB9XHJcbn0iXX0=